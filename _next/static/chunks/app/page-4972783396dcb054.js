(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{30539:function(e,s,t){Promise.resolve().then(t.bind(t,20802))},20802:function(e,s,t){"use strict";t.r(s),t.d(s,{Chat:function(){return ee}});var n,r,l,a,o=t(44462),i=t(39546),c=t(93345),d=t(57632),u=t(25882),m=t(88936);let p=(0,m.j)("inline-flex items-center justify-center rounded-md text-sm font-medium shadow ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-md hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"shadow-none hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 shadow-none hover:underline"},size:{default:"h-8 px-4 py-2",sm:"h-8 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-8 w-8 p-0"}},defaultVariants:{variant:"default",size:"default"}}),h=i.forwardRef((e,s)=>{let{className:t,variant:n,size:r,asChild:l=!1,...a}=e,i=l?u.g7:"button";return(0,o.jsx)(i,{className:(0,d.cn)(p({variant:n,size:r,className:t})),ref:s,...a})});h.displayName="Button";var f=t(37101),x=t(82982),g=t(14717),v=t(53055);function b(e){let{onSubmit:s,input:t,setInput:n,isLoading:r}=e,{formRef:l,onKeyDown:a}=function(){let e=(0,i.useRef)(null);return{formRef:e,onKeyDown:s=>{if("Enter"===s.key&&!s.shiftKey&&!s.nativeEvent.isComposing){var t;null===(t=e.current)||void 0===t||t.requestSubmit(),s.preventDefault()}}}}(),c=i.useRef(null),u=(0,v.useRouter)();return i.useEffect(()=>{c.current&&c.current.focus()},[]),(0,o.jsx)("form",{onSubmit:async e=>{e.preventDefault(),(null==t?void 0:t.trim())&&(n(""),await s(t))},ref:l,children:(0,o.jsxs)("div",{className:"relative flex max-h-60 w-full grow flex-col overflow-hidden bg-background px-8 sm:rounded-md sm:border sm:px-12",children:[(0,o.jsxs)(g.u,{children:[(0,o.jsx)(g.aJ,{asChild:!0,children:(0,o.jsxs)("button",{onClick:e=>{e.preventDefault(),u.refresh(),u.push("/")},className:(0,d.cn)(p({size:"sm",variant:"outline"}),"absolute left-0 top-4 h-8 w-8 rounded-full bg-background p-0 sm:left-4"),children:[(0,o.jsx)(x.IconPlus,{}),(0,o.jsx)("span",{className:"sr-only",children:"New Chat"})]})}),(0,o.jsx)(g._v,{children:"New Chat"})]}),(0,o.jsx)(f.Z,{ref:c,tabIndex:0,onKeyDown:a,rows:1,value:t,onChange:e=>n(e.target.value),placeholder:"Send a message.",spellCheck:!1,className:"min-h-[60px] w-full resize-none bg-transparent px-4 py-[1.3rem] focus-within:outline-none sm:text-sm"}),(0,o.jsx)("div",{className:"absolute right-0 top-4 sm:right-4",children:(0,o.jsxs)(g.u,{children:[(0,o.jsx)(g.aJ,{asChild:!0,children:(0,o.jsxs)(h,{type:"submit",size:"icon",disabled:r||""===t,children:[(0,o.jsx)(x.IconArrowElbow,{}),(0,o.jsx)("span",{className:"sr-only",children:"Send message"})]})}),(0,o.jsx)(g._v,{children:"Send message"})]})})]})})}function j(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,[s,t]=i.useState(!1);return i.useEffect(()=>{let s=()=>{t(window.innerHeight+window.scrollY>=document.body.offsetHeight-e)};return window.addEventListener("scroll",s,{passive:!0}),s(),()=>{window.removeEventListener("scroll",s)}},[e]),s}function y(e){let{className:s,...t}=e,n=j();return(0,o.jsxs)(h,{variant:"outline",size:"icon",className:(0,d.cn)("absolute right-4 top-1 z-10 bg-background transition-opacity duration-300 sm:right-8 md:top-2",n?"opacity-0":"opacity-100",s),onClick:()=>window.scrollTo({top:document.body.offsetHeight,behavior:"smooth"}),...t,children:[(0,o.jsx)(x.IconArrowDown,{}),(0,o.jsx)("span",{className:"sr-only",children:"Scroll to bottom"})]})}function w(e){let{href:s,children:t}=e;return(0,o.jsxs)("a",{href:s,target:"_blank",className:"inline-flex flex-1 justify-center gap-1 leading-4 hover:underline",children:[(0,o.jsx)("span",{children:t}),(0,o.jsx)("svg",{"aria-hidden":"true",height:"7",viewBox:"0 0 6 6",width:"7",className:"opacity-70",children:(0,o.jsx)("path",{d:"M1.25215 5.54731L0.622742 4.9179L3.78169 1.75597H1.3834L1.38936 0.890915H5.27615V4.78069H4.40513L4.41109 2.38538L1.25215 5.54731Z",fill:"currentColor"})})]})}function N(e){let{className:s,...t}=e;return(0,o.jsxs)("p",{className:(0,d.cn)("px-2 text-center text-xs leading-normal text-muted-foreground",s),...t,children:["Open source LLM helper factor built with"," ",(0,o.jsx)(w,{href:"https://github.com/unit-mesh/chocolate-factory",children:"Chocolate Factory"}),"."]})}function C(e){let{id:s,isLoading:t,stop:n,append:r,reload:l,input:a,setInput:i,messages:c}=e;return(0,o.jsxs)("div",{className:"fixed inset-x-0 bottom-0 bg-gradient-to-b from-muted/10 from-10% to-muted/30 to-50%",children:[(0,o.jsx)(y,{}),(0,o.jsxs)("div",{className:"mx-auto sm:max-w-3xl sm:px-4",children:[(0,o.jsx)("div",{className:"flex h-10 items-center justify-center",children:t?(0,o.jsxs)(h,{variant:"outline",onClick:()=>n(),className:"bg-background",children:[(0,o.jsx)(x.IconStop,{className:"mr-2"}),"Stop generating"]}):(null==c?void 0:c.length)>0&&(0,o.jsxs)(h,{variant:"outline",onClick:()=>l(),className:"bg-background",children:[(0,o.jsx)(x.IconRefresh,{className:"mr-2"}),"Regenerate response"]})}),(0,o.jsxs)("div",{className:"space-y-4 border-t bg-background px-4 py-2 shadow-lg sm:rounded-t-xl sm:border md:py-4",children:[(0,o.jsx)(b,{onSubmit:async e=>{await r({id:s,content:e,role:"user"})},input:a,setInput:i,isLoading:t}),(0,o.jsx)(N,{className:"hidden sm:block"})]})]})]})}var k=t(42862);let L=k.fC,z=k.ZA,I=k.B4,E=i.forwardRef((e,s)=>{let{className:t,children:n,...r}=e;return(0,o.jsxs)(k.xz,{ref:s,className:(0,d.cn)("flex h-9 w-full items-center justify-between rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),...r,children:[n,(0,o.jsx)(k.JO,{asChild:!0,children:(0,o.jsx)(x.IconChevronUpDown,{className:"opacity-50"})})]})});E.displayName=k.xz.displayName;let S=i.forwardRef((e,s)=>{let{className:t,children:n,position:r="popper",...l}=e;return(0,o.jsx)(k.h_,{children:(0,o.jsx)(k.VY,{ref:s,className:(0,d.cn)("relative z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md animate-in fade-in-80","popper"===r&&"translate-y-1",t),position:r,...l,children:(0,o.jsx)(k.l_,{className:(0,d.cn)("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n})})})});S.displayName=k.VY.displayName;let R=i.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,o.jsx)(k.__,{ref:s,className:(0,d.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...n})});R.displayName=k.__.displayName;let T=i.forwardRef((e,s)=>{let{className:t,children:n,...r}=e;return(0,o.jsxs)(k.ck,{ref:s,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...r,children:[(0,o.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,o.jsx)(k.wU,{children:(0,o.jsx)(x.IconCheck,{className:"h-4 w-4"})})}),(0,o.jsx)(k.eT,{children:n})]})});T.displayName=k.ck.displayName;let _=i.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,o.jsx)(k.Z0,{ref:s,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",t),...n})});_.displayName=k.Z0.displayName;let D=[{label:"Frontend",value:"frontend"},{label:"OpenAPI",value:"openapi"},{label:"Ktor",value:"ktor"},{label:"TestCase",value:"testcase"},{label:"SQL",value:"sql"},{label:"Custom",value:"custom"}];function A(e){var s;let{setDomain:t}=e,[n,r]=(0,i.useState)(D[0].value);return(0,o.jsx)("div",{className:"mx-auto max-w-2xl px-4",children:(0,o.jsxs)("div",{className:"rounded-lg border bg-background p-8",children:[(0,o.jsx)("h1",{className:"mb-2 text-lg font-semibold",children:"Welcome to use Chocolate Factory!"}),(0,o.jsxs)("p",{className:"mb-2 leading-normal text-muted-foreground",children:["This is an open source LLM application engine designed to empower you in creating your very own AI assistant. Built with"," ",(0,o.jsx)(w,{href:"https://unitmesh.cc",children:"Unit Mesh Team"}),"."]}),(0,o.jsx)("p",{className:"leading-normal text-muted-foreground",children:"You can start with select a LLM helper here:"}),(0,o.jsx)("div",{className:"mt-4 flex flex-col items-start space-y-2",children:(0,o.jsxs)(L,{value:n,onValueChange:e=>{r(e),t(e)},children:[(0,o.jsx)(E,{children:(0,o.jsx)(I,{placeholder:"Select a domain…","aria-label":n,children:null===(s=D.find(e=>e.value===n))||void 0===s?void 0:s.label})}),(0,o.jsx)(S,{children:(0,o.jsx)(z,{children:D.map(e=>(0,o.jsx)(T,{value:e.value,disabled:e.value===n,children:e.label},e.value))})})]})})]})})}var M=t(98184);function O(e){let{trackVisibility:s}=e,t=j(),{ref:n,entry:r,inView:l}=(0,M.YD)({trackVisibility:s,delay:100,rootMargin:"0px 0px -150px 0px"});return i.useEffect(()=>{t&&s&&!l&&(null==r||r.target.scrollIntoView({block:"start"}))},[l,r,t,s]),(0,o.jsx)("div",{ref:n,className:"h-px w-full"})}var H=t(44032);let U=i.forwardRef((e,s)=>{let{className:t,orientation:n="horizontal",decorative:r=!0,...l}=e;return(0,o.jsx)(H.f,{ref:s,decorative:r,orientation:n,className:(0,d.cn)("shrink-0 bg-border","horizontal"===n?"h-[1px] w-full":"h-full w-[1px]",t),...l})});U.displayName=H.f.displayName;var P=t(4627),V=t(73249),Z=t(6479),B=t(67629);function F(e){let{timeout:s=2e3}=e,[t,n]=i.useState(!1);return{isCopied:t,copyToClipboard:e=>{var t;(null===(t=navigator.clipboard)||void 0===t?void 0:t.writeText)&&e&&navigator.clipboard.writeText(e).then(()=>{n(!0),setTimeout(()=>{n(!1)},s)})}}}let Y={javascript:".js",python:".py",java:".java",c:".c",cpp:".cpp","c++":".cpp","c#":".cs",ruby:".rb",php:".php",swift:".swift","objective-c":".m",kotlin:".kt",typescript:".ts",go:".go",perl:".pl",rust:".rs",scala:".scala",haskell:".hs",lua:".lua",shell:".sh",sql:".sql",html:".html",css:".css"},K=function(e){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t="ABCDEFGHJKLMNPQRSTUVWXY3456789",n="";for(let s=0;s<e;s++)n+=t.charAt(Math.floor(Math.random()*t.length));return s?n.toLowerCase():n},q=(0,i.memo)(e=>{let{language:s,value:t}=e,{isCopied:n,copyToClipboard:r}=F({timeout:2e3});return(0,o.jsxs)("div",{className:"relative w-full font-sans codeblock bg-zinc-950",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between w-full px-6 py-2 pr-4 bg-zinc-800 text-zinc-100",children:[(0,o.jsx)("span",{className:"text-xs lowercase",children:s}),(0,o.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,o.jsxs)(h,{variant:"ghost",className:"hover:bg-zinc-800 focus-visible:ring-1 focus-visible:ring-slate-700 focus-visible:ring-offset-0",onClick:()=>{let e=Y[s]||".file",n="file-".concat(K(3,!0)).concat(e),r=window.prompt("Enter file name",n);if(!r)return;let l=new Blob([t],{type:"text/plain"}),a=URL.createObjectURL(l),o=document.createElement("a");o.download=r,o.href=a,o.style.display="none",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)},size:"icon",children:[(0,o.jsx)(x.IconDownload,{}),(0,o.jsx)("span",{className:"sr-only",children:"Download"})]}),(0,o.jsxs)(h,{variant:"ghost",size:"icon",className:"text-xs hover:bg-zinc-800 focus-visible:ring-1 focus-visible:ring-slate-700 focus-visible:ring-offset-0",onClick:()=>{n||r(t)},children:[n?(0,o.jsx)(x.IconCheck,{}):(0,o.jsx)(x.IconCopy,{}),(0,o.jsx)("span",{className:"sr-only",children:"Copy code"})]})]})]}),(0,o.jsx)(Z.Z,{language:s,style:B.RY,PreTag:"div",showLineNumbers:!0,customStyle:{margin:0,width:"100%",background:"transparent",padding:"1.5rem 1rem"},codeTagProps:{style:{fontSize:"0.9rem",fontFamily:"var(--font-mono)"}},children:t})]})});q.displayName="CodeBlock";var J=t(1373);let Q=(0,i.memo)(J.D,(e,s)=>e.children===s.children&&e.className===s.className);function W(e){let{message:s,className:t,...n}=e,{isCopied:r,copyToClipboard:l}=F({timeout:2e3});return(0,o.jsx)("div",{className:(0,d.cn)("flex items-center justify-end transition-opacity group-hover:opacity-100 md:absolute md:-right-10 md:-top-2 md:opacity-0",t),...n,children:(0,o.jsxs)(h,{variant:"ghost",size:"icon",onClick:()=>{r||l(s.content)},children:[r?(0,o.jsx)(x.IconCheck,{}):(0,o.jsx)(x.IconCopy,{}),(0,o.jsx)("span",{className:"sr-only",children:"Copy message"})]})})}function G(e){let{message:s,...t}=e;return(0,o.jsxs)("div",{className:(0,d.cn)("group relative mb-4 flex items-start md:-ml-12"),...t,children:[(0,o.jsx)("div",{className:(0,d.cn)("flex h-8 w-8 shrink-0 select-none items-center justify-center rounded-md border shadow","user"===s.role?"bg-background":"bg-primary text-primary-foreground"),children:"user"===s.role?(0,o.jsx)(x.IconUser,{}):(0,o.jsx)(x.IconOpenAI,{})}),(0,o.jsxs)("div",{className:"flex-1 px-1 ml-4 space-y-2 overflow-hidden",children:[(0,o.jsx)(Q,{className:"prose break-words dark:prose-invert prose-p:leading-relaxed prose-pre:p-0",remarkPlugins:[P.Z,V.Z],components:{p(e){let{children:s}=e;return(0,o.jsx)("p",{className:"mb-2 last:mb-0",children:s})},code(e){let{node:s,inline:t,className:n,children:r,...l}=e;if(r.length){if("▍"==r[0])return(0,o.jsx)("span",{className:"mt-1 cursor-default animate-pulse",children:"▍"});r[0]=r[0].replace("`▍`","▍")}let a=/language-(\w+)/.exec(n||"");return t?(0,o.jsx)("code",{className:n,...l,children:r}):(0,o.jsx)(q,{language:a&&a[1]||"",value:String(r).replace(/\n$/,""),...l},Math.random())}},children:s.content}),(0,o.jsx)(W,{message:s})]})]})}function X(e){let{messages:s}=e;return s.length?(0,o.jsx)("div",{className:"relative mx-auto max-w-3xl px-4",children:s.map((e,t)=>(0,o.jsxs)("div",{children:[(0,o.jsx)(G,{message:e}),t<s.length-1&&(0,o.jsx)(U,{className:"my-4 md:my-8"})]},t))}):null}(n=l||(l={}))[n.NONE=0]="NONE",n[n.ONE_CHAT=1]="ONE_CHAT",n[n.MULTI_CHAT=2]="MULTI_CHAT";class ${get currentPrompt(){return this.prompts.find(e=>!e.isDone)}static default(){return new $}constructor(){this.prompts=[]}}function ee(e){var s,t;let{id:n,initialMessages:r,className:l}=e,[u,m]=(0,i.useState)(D[0].value),[p,h]=(0,i.useState)($.default()),[f,x]=(0,i.useState)((null==p?void 0:null===(s=p.prompts)||void 0===s?void 0:s.length)?p.prompts[0]:null);(0,i.useEffect)(()=>{fetch("http://localhost:18080/api/workflows/".concat(u)).then(e=>e.json()).then(e=>{h(e),x((null==e?void 0:e.length)?e[0]:null)})},[u]);let{messages:g,append:v,reload:b,stop:j,isLoading:y,input:w,setInput:N}=(0,c.R)({api:"http://localhost:18080/api/chat",initialMessages:r,id:n,headers:{"Content-Type":"application/json"},body:{stage:null!==(t=null==f?void 0:f.stage)&&void 0!==t?t:a.Classify,id:n,domain:u},onResponse:e=>{console.log(e.body)}});return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:(0,d.cn)("pb-[200px] pt-4 md:pt-10",l),children:g.length?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(X,{messages:g}),(0,o.jsx)(O,{trackVisibility:y})]}):(0,o.jsx)(A,{setDomain:e=>{m(e)}})}),(0,o.jsx)(C,{id:n,isLoading:y,stop:j,append:v,reload:b,messages:g,input:w,setInput:N})]})}(r=a||(a={})).Classify="Classify",r.Clarify="Clarify",r.Analyze="Analyze",r.Design="Design",r.Execute="Execute",r.Custom="Custom"}},function(e){e.O(0,[143,491,811,33,191,744],function(){return e(e.s=30539)}),_N_E=e.O()}]);